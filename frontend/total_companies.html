<div id="header-placeholder"></div>
    <br><br><br><br>

<!-- ------------------------------------------------------------------------------------ search bar -------------------------------------------------------------------------------------- -->

    <h2 class="page-heading">Search your Dream Company</h2>
    <div class="search-categories">
        <div class="search-box">
            <input type="text" placeholder="Search for jobs, companies, keywords...">
            <button type="submit"><i class="fas fa-search"></i></button>
        </div>
    </div>

<!-- ------------------------------------------------------------------------------------ company cards -------------------------------------------------------------------------------------- -->
<br><br>
<div class="card-companies-container">
    <!-- Company cards will be populated dynamically here -->
</div>

<script>
    // Function to fetch job data from the API
    fetch('/company/add?id=0')
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(response => {
            console.log(response); // Inspect the data structure here

            const jobs = response.data; // Assuming response.data contains the jobs array
            console.log(jobs);

            // Check if jobs is an array and contains data
            if (Array.isArray(jobs) && jobs.length > 0) {
                const cardCompaniesContainer = document.querySelector('.card-companies-container');
                cardCompaniesContainer.innerHTML = ''; // Clear any existing content

                // Group jobs by company name
                const companies = {};
                jobs.forEach(job => {
                    if (!companies[job.name_of_company]) {
                        companies[job.name_of_company] = {
                            name: job.name_of_company,
                            location: job.company_address, // Assuming 'company_address' is the location field
                            totalJobs: 0,
                            logo: job.filename || 'images/placeholder.png',
                        };
                    }
                    companies[job.name_of_company].totalJobs++;
                });

                // Loop through all companies and display them
                Object.values(companies).forEach(company => {
                    const companyCard = document.createElement('div');
                    companyCard.classList.add('card-company');

                    companyCard.innerHTML = `
                        <div class="card-company-left">
                            <img src="${company.logo}" alt="${company.name} Logo" class="card-company-logo">
                            <div class="card-company-details">
                                <h3>${company.name}</h3>
                                <p><i class="fa-solid fa-location-dot"></i> ${company.location || 'Location not available'}</p>
                            </div>
                        </div>
                        <div class="card-company-right">
                            <i class="fa-solid fa-briefcase"></i>
                            <p>${company.totalJobs}</p>
                            <p>Jobs</p>
                        </div>
                    `;

                    // Append the company card to the container
                    cardCompaniesContainer.appendChild(companyCard);
                });
            } else {
                console.error('Expected an array, but got:', jobs);
            }
        })
        .catch(error => console.error('Error fetching job data:', error));
</script>

</body>
</html>



<!---------------------------------------------------------------------------------------------- footer section ---------------------------------------------------------------------  -->
<div id="footer-placeholder"></div>
    <script>
        // Load header and footer
        document.addEventListener("DOMContentLoaded", function() {
            const headerPlaceholder = document.getElementById('header-placeholder');
            const footerPlaceholder = document.getElementById('footer-placeholder');

            fetch('/header')
                .then(response => response.text())
                .then(data => {
                    headerPlaceholder.innerHTML = data;
                    // Initialize toggle button after header is loaded
                    initToggleButton();
                });

            fetch('/footer')
                .then(response => response.text())
                .then(data => {
                    footerPlaceholder.innerHTML = data;
                });

            // Function to initialize toggle button
            function initToggleButton() {
                const toggleButton = document.querySelector(".toggle-button");
                const navLinks = document.querySelector("nav.nav-links");

                if (toggleButton && navLinks) {
                    toggleButton.addEventListener("click", () => {
                        navLinks.classList.toggle("show");
                        console.log("Toggle button clicked. Nav links class is now:", navLinks.className);
                    });
                }
            }

            // Infinite scroll functionality
            const scrollWrapper = document.getElementById('manpower-cards');
            if (scrollWrapper) {
                const cards = Array.from(scrollWrapper.children);
                // Clone the cards to create an infinite scroll effect
                cards.forEach(card => {
                    const clone = card.cloneNode(true);
                    scrollWrapper.appendChild(clone);
                });
            }

            // Image card click functionality
            const imgCard = document.querySelectorAll(".img-card");
            imgCard.forEach(element => {
                element.addEventListener("click", function(e) {
                    imgCard.forEach(el => {
                        el.classList.remove("active");
                    });
                    element.classList.add("active");
                });
            });
        });
    </script>
</body>
</html>
