<div id="header-placeholder"></div>
<body>
    <br><br><br><br><br><br><br><br>
    <div class="job-listing">
        <div class="header">
            <img id="job-logo" src="images/placeholder.png" alt="Default logo" class="logo-detail"> <!-- Add ID here -->
            <button class="apply-btn">Apply now</button>
        </div>
        <div class="details">
            <p><strong>Position:</strong> <span id="job-position"></span></p>
        </div>
        <div class="info-grid">
            <div>
                <p><strong>No. of Vacancies</strong></p>
                <p id="job-vacancies"></p>
            </div>
            <div>
                <p><strong>Category</strong></p>
                <p id="job-category"></p>
            </div>
            <div>
                <p><strong>Salary</strong></p>
                <p id="job-salary"></p>
            </div>
            <div>
                <p><strong>Job Type</strong></p>
                <p id="job-type"></p>
            </div>
            <div>
                <p><strong>Starting Date</strong></p>
                <p id="job-starting-date"></p>
            </div>
            <div>
                <p><strong>Ending Date</strong></p>
                <p id="job-ending-date"></p>
            </div>
            <div>
                <p><strong>Gender Required</strong></p>
                <p id="job-gender"></p>
            </div>
            <div>
                <p><strong>Education Required</strong></p>
                <p id="job-education"></p>
            </div>
        </div>
        <div class="job-description">
            <h3>Job Summary</h3>
            <p id="job-summary"></p>
        </div>
        <div class="job-description">
            <h3>Job Descriptions</h3>
            <p id="job-description"></p>
        </div>
        <div class="job-description">
            <h3>Job Skills</h3>
            <p id="job-skills"></p>
        </div>
    </div>

    <script>
        function getJobIdFromURL() {
            const params = new URLSearchParams(window.location.search);
            return params.get('id');
        }

        // Function to fetch job details
        function fetchJobDetails(jobId) {
            fetch(`/company/add?id=${jobId}`)
                .then(response => {
                    if (!response.ok) {
                        return response.text().then(text => {
                            throw new Error(`Network response was not ok: ${text}`);
                        });
                    }
                    return response.json();
                })
                .then(response => {
                    const data = response.data; // Access the nested data object

                    console.log(data); // Log the response data for inspection

                    // Populate the job details with the correct properties from the API response
                    document.getElementById('job-logo').src = data.filename || 'images/placeholder.png';
                    document.getElementById('job-position').innerText = data.position || 'N/A';
                    document.getElementById('job-vacancies').innerText = data.no_of_vacancies || 'N/A';
                    document.getElementById('job-category').innerText = data.category_name || 'N/A'; // Use category_name instead of category_id
                    document.getElementById('job-salary').innerText = data.salary || 'N/A';
                    document.getElementById('job-type').innerText = data.time || 'N/A';
                    document.getElementById('job-starting-date').innerText = data.starting_date ? new Date(data.starting_date).toDateString() : 'N/A';
                    document.getElementById('job-ending-date').innerText = data.ending_date ? new Date(data.ending_date).toDateString() : 'N/A';
                    document.getElementById('job-gender').innerText = data.gender || 'N/A';
                    document.getElementById('job-education').innerText = data.education_required || 'N/A';
                    document.getElementById('job-summary').innerText = data.job_summary || 'N/A';
                    document.getElementById('job-description').innerText = data.job_description || 'N/A';
                    document.getElementById('job-skills').innerText = data.skills || 'N/A';
                })
                .catch(error => console.error('Error fetching job details:', error));
            }

        // Execute when the document is ready
        document.addEventListener("DOMContentLoaded", function() {
            const jobId = getJobIdFromURL();
            if (jobId) {
                fetchJobDetails(jobId); // Call the fetch function
            } else {
                console.error('No job ID found in URL');
            }
        });
    </script>
    <br><br><br><br><br>
    <div id="footer-placeholder"></div>
    <script>
        // Load header and footer
        document.addEventListener("DOMContentLoaded", function() {
            const headerPlaceholder = document.getElementById('header-placeholder');
            const footerPlaceholder = document.getElementById('footer-placeholder');

            fetch('header.html')
                .then(response => response.text())
                .then(data => {
                    headerPlaceholder.innerHTML = data;
                    // Initialize toggle button after header is loaded
                    initToggleButton();
                });

            fetch('footer.html')
                .then(response => response.text())
                .then(data => {
                    footerPlaceholder.innerHTML = data;
                });

            // Function to initialize toggle button
            function initToggleButton() {
                const toggleButton = document.querySelector(".toggle-button");
                const navLinks = document.querySelector("nav.nav-links");

                if (toggleButton && navLinks) {
                    toggleButton.addEventListener("click", () => {
                        navLinks.classList.toggle("show");
                        console.log("Toggle button clicked. Nav links class is now:", navLinks.className);
                    });
                }
            }

            // Infinite scroll functionality
            const scrollWrapper = document.getElementById('manpower-cards');
            if (scrollWrapper) {
                const cards = Array.from(scrollWrapper.children);
                // Clone the cards to create an infinite scroll effect
                cards.forEach(card => {
                    const clone = card.cloneNode(true);
                    scrollWrapper.appendChild(clone);
                });
            }

            // Image card click functionality
            const imgCard = document.querySelectorAll(".img-card");
            imgCard.forEach(element => {
                element.addEventListener("click", function(e) {
                    imgCard.forEach(el => {
                        el.classList.remove("active");
                    });
                    element.classList.add("active");
                });
            });
        });
    </script>